/*! For license information please see app~3a552275.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkkalkulori=self.webpackChunkkalkulori||[]).push([[556],{176:(e,n,t)=>{t.d(n,{Gj:()=>s,aI:()=>u,dk:()=>h,g7:()=>p,jy:()=>d});var a=t(774);function r(){r=function(){return n};var e,n={},t=Object.prototype,a=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function d(e,n,t,a){return Object.defineProperty(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a})}try{d({},"")}catch(e){d=function(e,n,t){return e[n]=t}}function u(n,t,a,r){var o=t&&t.prototype instanceof f?t:f,i=Object.create(o.prototype);return d(i,"_invoke",function(n,t,a){var r=1;return function(o,i){if(3===r)throw Error("Generator is already running");if(4===r){if("throw"===o)throw i;return{value:e,done:!0}}for(a.method=o,a.arg=i;;){var l=a.delegate;if(l){var s=x(l,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(1===r)throw r=4,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=3;var c=p(n,t,a);if("normal"===c.type){if(r=a.done?4:2,c.arg===m)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r=4,a.method="throw",a.arg=c.arg)}}}(n,a,new A(r||[])),!0),i}function p(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}n.wrap=u;var m={};function f(){}function v(){}function g(){}var h={};d(h,i,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(I([])));b&&b!==t&&a.call(b,i)&&(h=b);var _=g.prototype=f.prototype=Object.create(h);function w(e){["next","throw","return"].forEach((function(n){d(e,n,(function(e){return this._invoke(n,e)}))}))}function k(e,n){function t(r,o,i,s){var c=p(e[r],e,o);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==l(u)&&a.call(u,"__await")?n.resolve(u.__await).then((function(e){t("next",e,i,s)}),(function(e){t("throw",e,i,s)})):n.resolve(u).then((function(e){d.value=e,i(d)}),(function(e){return t("throw",e,i,s)}))}s(c.arg)}var r;d(this,"_invoke",(function(e,a){function o(){return new n((function(n,r){t(e,a,n,r)}))}return r=r?r.then(o,o):o()}),!0)}function x(n,t){var a=t.method,r=n.i[a];if(r===e)return t.delegate=null,"throw"===a&&n.i.return&&(t.method="return",t.arg=e,x(n,t),"throw"===t.method)||"return"!==a&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+a+"' method")),m;var o=p(r,n.i,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,m;var i=o.arg;return i?i.done?(t[n.r]=i.value,t.next=n.n,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,m):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function E(e){this.tryEntries.push(e)}function S(n){var t=n[4]||{};t.type="normal",t.arg=e,n[4]=t}function A(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function I(n){if(null!=n){var t=n[i];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,o=function t(){for(;++r<n.length;)if(a.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=e,t.done=!0,t};return o.next=o}}throw new TypeError(l(n)+" is not iterable")}return v.prototype=g,d(_,"constructor",g),d(g,"constructor",v),v.displayName=d(g,c,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===v||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},n.awrap=function(e){return{__await:e}},w(k.prototype),d(k.prototype,s,(function(){return this})),n.AsyncIterator=k,n.async=function(e,t,a,r,o){void 0===o&&(o=Promise);var i=new k(u(e,t,a,r),o);return n.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(_),d(_,c,"Generator"),d(_,i,(function(){return this})),d(_,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),t=[];for(var a in n)t.unshift(a);return function e(){for(;t.length;)if((a=t.pop())in n)return e.value=a,e.done=!1,e;return e.done=!0,e}},n.values=I,A.prototype={constructor:A,reset:function(n){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!n)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function a(e){i.type="throw",i.arg=n,t.next=e}for(var r=t.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o[4],l=this.prev,s=o[1],c=o[2];if(-1===o[0])return a("end"),!1;if(!s&&!c)throw Error("try statement without catch or finally");if(null!=o[0]&&o[0]<=l){if(l<s)return this.method="next",this.arg=e,a(s),!0;if(l<c)return a(c),!1}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a[0]>-1&&a[0]<=this.prev&&this.prev<a[2]){var r=a;break}}r&&("break"===e||"continue"===e)&&r[0]<=n&&n<=r[2]&&(r=null);var o=r?r[4]:{};return o.type=e,o.arg=n,r?(this.method="next",this.next=r[2],m):this.complete(o)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),m},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t[2]===e)return this.complete(t[4],t[3]),S(t),m}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t[0]===e){var a=t[4];if("throw"===a.type){var r=a.arg;S(t)}return r}}throw Error("illegal catch attempt")},delegateYield:function(n,t,a){return this.delegate={i:I(n),r:t,n:a},"next"===this.method&&(this.arg=e),m}},n}function o(e,n,t,a,r,o,i){try{var l=e[o](i),s=l.value}catch(e){return void t(e)}l.done?n(s):Promise.resolve(s).then(a,r)}function i(e){return function(){var n=this,t=arguments;return new Promise((function(a,r){var i=e.apply(n,t);function l(e){o(i,a,r,l,s,"next",e)}function s(e){o(i,a,r,l,s,"throw",e)}l(void 0)}))}}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var s=function(e){var n=localStorage.getItem("userId")||"anonymous";console.log("üîÑ formatMealPlanData input for user",n,":",JSON.stringify(e,null,2)),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FormatInput";console.log("üîç ".concat(n," Analysis:")),console.log("=================================="),e?(console.log("üìã Input type:",l(e)),console.log("üìã Input keys:",Object.keys(e)),e.meal_plans&&(console.log("üìã Has meal_plans property"),console.log("üìã meal_plans type:",l(e.meal_plans)),console.log("üìã meal_plans is array:",Array.isArray(e.meal_plans)),Array.isArray(e.meal_plans)&&(console.log("üìã meal_plans length:",e.meal_plans.length),e.meal_plans.length>0&&(console.log("üìã First plan keys:",Object.keys(e.meal_plans[0])),console.log("üìã First plan sample:",JSON.stringify(e.meal_plans[0],null,4))))),console.log("üìã Checking for meal types:"),["breakfast","lunch","dinner","Breakfast","Lunch","Dinner","BREAKFAST","LUNCH","DINNER"].forEach((function(n){e[n]&&(console.log("  ‚úÖ Found ".concat(n,":"),Object.keys(e[n])),console.log("  üìÑ ".concat(n," data:"),JSON.stringify(e[n],null,4)))})),console.log("==================================")):console.log("‚ùå Input is null/undefined")}(e,"formatMealPlanData Input");var t=null;if(e&&e.meal_plans&&Array.isArray(e.meal_plans)&&e.meal_plans.length>0)t=e.meal_plans[0],console.log("üì¶ Using meal plan from API response (Case 1) for user",n,":",t);else{if(!e||!(e.breakfast||e.lunch||e.dinner||e.Breakfast||e.Lunch||e.Dinner))return console.log("‚ùå No valid meal plans found in input for user",n),[];t=e,console.log("üì¶ Using direct meal plan object (Case 2) for user",n,":",t)}var a=Object.keys(t);console.log("üîç Available meal keys in plan data for user",n,":",a);var r=[];return[{key:"breakfast",display:"Breakfast"},{key:"lunch",display:"Lunch"},{key:"dinner",display:"Dinner"}].forEach((function(e){var a=e.key,o=e.display;console.log("üîç Looking for ".concat(a," variations for user ").concat(n,"..."));for(var i=null,l=null,s=0,d=[a,a.charAt(0).toUpperCase()+a.slice(1),a.toUpperCase()];s<d.length;s++){var u=d[s];if(t[u]){i=t[u],l=u,console.log("‚úÖ Found ".concat(a,' as "').concat(l,'" for user ').concat(n,":"),i);break}}if(i){var p={type:o,name:i.Name||i.food_name||i.name||"Unknown ".concat(o),image:c(i.Image)||i.image_url||"./public/image/meals/".concat(a,"-default.jpg"),calories:Math.round(i.Calories||i.calories_per_serving||i.calories||0),id:i.RecipeId||i.id||i.recipe_id||"".concat(a,"_").concat(n,"_").concat(Date.now()),serving_size:i.serving_size||i.ServingSize||1,serving_unit:i.serving_unit||i.ServingUnit||"serving",recipe_id:i.RecipeId||i.recipe_id||i.id||null,protein:i.protein||i.ProteinContent||0,carbs:i.carbs||i.CarbohydrateContent||0,fat:i.fat||i.FatContent||0,user_id:n};console.log("‚úÖ Formatted ".concat(a," for user ").concat(n,":"),p),r.push(p)}else{console.log("‚ùå Missing ".concat(a," in plan data for user ").concat(n));var m={type:o,name:"Default ".concat(o),image:"./public/image/meals/".concat(a,"-default.jpg"),calories:300,id:"default_".concat(a,"_").concat(n,"_").concat(Date.now()),serving_size:1,serving_unit:"serving",recipe_id:null,protein:15,carbs:40,fat:10,user_id:n};console.log("üîß Using default ".concat(a," for user ").concat(n,":"),m),r.push(m)}})),console.log("üîÑ formatMealPlanData output for user",n,":",r),console.log("üîÑ Total formatted meals for user",n,":",r.length),r},c=function(e){if(!e||"string"!=typeof e)return null;var n=e.replace(/\\\//g,"/").split(/,\s*(?=https?:\/\/)/)[0];return n&&n.trim()?n.trim().replace(/^"|"$/g,""):null},d=function(e){var n=localStorage.getItem("userId")||"anonymous",t=e.reduce((function(e,n){return e+(n.calories||0)}),0);return console.log("üßÆ Total calories calculated for user",n,":",t),t},u=function(){var e=localStorage.getItem("userId")||"anonymous";return console.log("üìã Generating default meal plan for user:",e),[{type:"Breakfast",name:"Fried Chicken Wings",image:"./public/image/meals/fried-chicken-wings.jpg",calories:400,id:"default_breakfast_".concat(e),serving_size:1,serving_unit:"serving",user_id:e},{type:"Lunch",name:"Fried Rice with Egg",image:"./public/image/meals/fried-rice-egg.jpg",calories:450,id:"default_lunch_".concat(e),serving_size:1,serving_unit:"serving",user_id:e},{type:"Dinner",name:"Soto Ayam",image:"./public/image/meals/soto-ayam.jpg",calories:350,id:"default_dinner_".concat(e),serving_size:1,serving_unit:"serving",user_id:e}]},p=function(e){var n,t,a=localStorage.getItem("userId")||"anonymous";if(console.log("üé® createMealPlanSection called with data for user",a,":",{loading:e.loading,error:e.error,plansExists:!!e.plans,plansLength:(null===(n=e.plans)||void 0===n?void 0:n.length)||0,totalCalories:e.totalCalories,targetCalories:e.targetCalories,dataKeys:e?Object.keys(e):[]}),!e)return console.log("üé® No data provided, rendering error state for user:",a),'\n      <div class="error-container">\n        <div class="error-icon">‚ö†Ô∏è</div>\n        <p class="error-message">No meal plan data available</p>\n        <button class="retry-btn" id="generate-meal-plan-btn">Generate Plan</button>\n      </div>\n    ';if(e.loading)return console.log("üé® Rendering loading state for user:",a),'\n      <div class="loading-container">\n        <div class="loading-spinner"></div>\n        <p>Generating personalized meal plan...</p>\n      </div>\n    ';if(e.error){console.log("üé® Rendering error state for user",a,":",e.error);var r=e.error.includes("profile")||e.error.includes("calorie target")||e.error.includes("Profil")||e.error.includes("complete your profile")||e.error.includes("Profile setup required"),o=r?"Complete Profile":"Try Again",i=r?"complete-profile-btn":"generate-meal-plan-btn";return'\n      <div class="error-container">\n        <div class="error-icon">‚ö†Ô∏è</div>\n        <p class="error-message">'.concat(e.error,'</p>\n        <button class="retry-btn" id="').concat(i,'">').concat(o,"</button>\n      </div>\n    ")}if(!e.plans||!Array.isArray(e.plans)||0===e.plans.length)return console.log("üé® Rendering no plans state for user",a,"- plans validation:",{plansExists:!!e.plans,plansIsArray:Array.isArray(e.plans),plansLength:(null===(t=e.plans)||void 0===t?void 0:t.length)||0,plansContent:e.plans}),'\n      <div class="error-container">\n        <div class="error-icon">üçΩÔ∏è</div>\n        <p class="error-message">No meal plans available</p>\n        <button class="retry-btn" id="generate-meal-plan-btn">Generate Plan</button>\n      </div>\n    ';var l=e.totalCalories||d(e.plans)||0,s=e.targetCalories||1500;return console.log("üé® Rendering meal plan content with",e.plans.length,"plans for user:",a),console.log("üé® Calorie info for user",a,":",{totalCalories:l,targetCalories:s}),'\n    <div class="meal-plan-content">\n      <div class="meal-plan-header">\n        <div class="meal-plan-calories">\n          <span class="current-calories">'.concat(l,'</span>\n          <span class="calories-separator">kcal/</span>\n          <span class="target-calories">').concat(s,'</span>\n        </div>\n        <div class="meal-plan-buttons">\n          <button class="generate-plan-btn add-plan-btn" id="add-full-meal-plan-btn">\n            <span class="btn-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#FFFFFF"><path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"/></svg></span>\n            Add Plan\n          </button>\n          <button class="generate-plan-btn" id="generate-meal-plan-btn">\n            <span class="btn-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#FFFFFF"><path d="M204-318q-22-38-33-78t-11-82q0-134 93-228t227-94h7l-64-64 56-56 160 160-160 160-56-56 64-64h-7q-100 0-170 70.5T240-478q0 26 6 51t18 49l-60 60ZM481-40 321-200l160-160 56 56-64 64h7q100 0 170-70.5T720-482q0-26-6-51t-18-49l60-60q22 38 33 78t11 82q0 134-93 228t-227 94h-7l64 64-56 56Z"/></svg></span>\n            New Plan\n          </button>\n        </div>\n      </div>\n      \n      <div class="meal-plan-grid">\n        ').concat(e.plans.map((function(e){return m(e)})).join(""),"\n      </div>\n      \n      ").concat(e.plans.length<3?'\n        <div class="meal-plan-notice">\n          <p>‚ö†Ô∏è Some meals may be using default options. Try generating a new plan.</p>\n        </div>\n      ':"","\n    </div>\n  ")},m=function(e){var n=localStorage.getItem("userId")||"anonymous";if(!e)return console.warn("‚ö†Ô∏è No meal data provided to createMealPlanCard for user:",n),"";var t=e.type||"Meal",a=e.name||"Unknown Meal",r=e.calories||0,o=e.image||"./public/image/meals/default-meal.jpg",i=e.id||e.recipe_id||"meal_".concat(n,"_").concat(Date.now());return console.log("üÉè Creating meal card for user",n,":",{mealType:t,mealName:a,mealCalories:r,mealId:i}),'\n    <div class="meal-plan-card" data-meal-type="'.concat(t.toLowerCase(),'" data-meal-id="').concat(i,'" data-user-id="').concat(n,'">\n      <div class="meal-plan-image" data-meal-details-trigger>\n        <img src="').concat(o,'" alt="').concat(a,'" onerror="this.src=\'./public/image/meals/default-meal.jpg\'; this.onerror=null;">\n        <div class="image-overlay">\n          <span class="view-details-text"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#FFFFFF"><path d="M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-146 0-266-81.5T40-500q54-137 174-218.5T480-800q146 0 266 81.5T920-500q-54 137-174 218.5T480-200Zm0-300Zm0 220q113 0 207.5-59.5T832-500q-50-101-144.5-160.5T480-720q-113 0-207.5 59.5T128-500q50 101 144.5 160.5T480-280Z"/></svg> View Details</span>\n        </div>\n      </div>\n      <div class="meal-plan-info">\n        <div class="meal-type">').concat(t,'</div>\n        <div class="meal-name" title="').concat(a,'">').concat(a,'</div>\n        <div class="meal-calories">').concat(r," kcal</div>\n        ").concat(e.protein||e.carbs||e.fat?'\n          <div class="meal-nutrition-mini">\n            '.concat(e.protein?"P: ".concat(Math.round(e.protein),"g "):"","\n            ").concat(e.carbs?"C: ".concat(Math.round(e.carbs),"g "):"","\n            ").concat(e.fat?"F: ".concat(Math.round(e.fat),"g"):"","\n          </div>\n        "):"",'\n      </div>\n      <button class="meal-plan-add-btn" data-meal=\'').concat(JSON.stringify({id:i,name:a,calories:r,serving_size:e.serving_size||1,serving_unit:e.serving_unit||"serving",type:t,image:o,recipe_id:e.recipe_id||e.id,user_id:n}),'\' title="Add to diary">\n        <span class="plus-icon">+</span>\n      </button>\n    </div>\n  ')},f=function(){var e=new Date,n=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(n,"-").concat(t,"-").concat(a)},v=function(){var e=i(r().mark((function e(n){var t,o,i,l,s,c,d,u,p;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("userId")||"anonymous",console.log("üçΩÔ∏è Adding full meal plan for user",t,":",n),e.prev=2,o=f(),i={meal_plan:{},log_date:o},n.forEach((function(e){if(e.user_id&&e.user_id!==t)console.warn("‚ö†Ô∏è Skipping meal from different user:",e.user_id,"current:",t);else{var n=e.type.toLowerCase();["breakfast","lunch","dinner"].includes(n)&&(i.meal_plan[n]={RecipeId:e.recipe_id||e.id,Name:e.name,Calories:e.calories,Image:e.image})}})),0!==Object.keys(i.meal_plan).length){e.next=8;break}throw new Error("No valid meals to add for current user");case 8:return console.log("üçΩÔ∏è Adding full meal plan for user",t,":",i),e.prev=9,e.next=12,a.A.addFullMealPlan(i);case 12:alert("Full meal plan added successfully!"),e.next=67;break;case 15:if(e.prev=15,e.t0=e.catch(9),console.warn("üîÑ Full meal plan endpoint failed for user",t,", trying individual meals:",e.t0.message),!(e.t0.message.includes("Endpoint not found")||e.t0.message.includes("404")||e.t0.message.includes("Network error"))){e.next=66;break}console.log("üîÑ Falling back to individual meal additions for user:",t),l=0,s=0,c=0;case 23:if(!(c<n.length)){e.next=59;break}if(!(u=n[c]).user_id||u.user_id===t){e.next=28;break}return console.warn("‚ö†Ô∏è Skipping meal from different user during individual add:",u.user_id),e.abrupt("continue",56);case 28:if(!u.recipe_id||null!==(d=u.id)&&void 0!==d&&d.toString().startsWith("default_")){e.next=42;break}return e.prev=29,e.next=32,a.A.addMealFromPlan({recipe_id:u.recipe_id,meal_type:u.type.toLowerCase(),servings:1,log_date:o});case 32:l++,console.log("‚úÖ Added ".concat(u.name," successfully for user ").concat(t)),e.next=40;break;case 36:e.prev=36,e.t1=e.catch(29),s++,console.error("‚ùå Failed to add ".concat(u.name," for user ").concat(t,":"),e.t1);case 40:e.next=53;break;case 42:return e.prev=42,e.next=45,a.A.createMealEntry({food_item_id:u.id,meal_type:u.type.toLowerCase(),servings:1,log_date:o});case 45:l++,console.log("‚úÖ Added ".concat(u.name," (default) successfully for user ").concat(t)),e.next=53;break;case 49:e.prev=49,e.t2=e.catch(42),s++,console.error("‚ùå Failed to add ".concat(u.name," (default) for user ").concat(t,":"),e.t2);case 53:if(!(c<n.length-1)){e.next=56;break}return e.next=56,new Promise((function(e){return setTimeout(e,300)}));case 56:c++,e.next=23;break;case 59:if(!(l>0)){e.next=63;break}alert("Meal plan added successfully! ".concat(l," meals added").concat(s>0?", ".concat(s," failed"):"",".")),e.next=64;break;case 63:throw new Error("Failed to add any meals from the plan");case 64:e.next=67;break;case 66:throw e.t0;case 67:p=new CustomEvent("mealPlanMealAdded"),document.dispatchEvent(p),e.next=75;break;case 71:e.prev=71,e.t3=e.catch(2),console.error("Error adding full meal plan for user",t,":",e.t3),alert("Failed to add meal plan: ".concat(e.t3.message));case 75:case"end":return e.stop()}}),e,null,[[2,71],[9,15],[29,36],[42,49]])})));return function(n){return e.apply(this,arguments)}}(),g=function(){var e=i(r().mark((function e(n){var t,o,i,l,s,c,d,u,p,m,f,v,g,h,y,b,_;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=localStorage.getItem("userId")||"anonymous",console.log("üîç Showing meal details popup for user",i,":",n),(l=document.getElementById("meal-details-popup-overlay"))&&l.remove(),s="",s=!n.recipe_id||null!==(t=n.id)&&void 0!==t&&t.toString().startsWith("default_")?'\n      <div class="meal-details-content">\n        <div class="meal-details-header">\n          <img src="'.concat(n.image||"https://images.unsplash.com/photo-1546554137-f86b9593a222",'" alt="').concat(n.name,'">\n          <div class="meal-basic-info">\n            <h3>').concat(n.name,'</h3>\n            <p class="meal-calories">').concat(n.calories,' kcal per serving</p>\n          </div>\n        </div>\n        \n        <div class="meal-nutrition">\n          <h4>Nutrition per serving:</h4>\n          <div class="nutrition-grid">\n            <div class="nutrition-item">\n              <span class="nutrition-label">Protein</span>\n              <span class="nutrition-value">').concat(Math.round(n.protein||0),'g</span>\n            </div>\n            <div class="nutrition-item">\n              <span class="nutrition-label">Carbs</span>\n              <span class="nutrition-value">').concat(Math.round(n.carbs||0),'g</span>\n            </div>\n            <div class="nutrition-item">\n              <span class="nutrition-label">Fat</span>\n              <span class="nutrition-value">').concat(Math.round(n.fat||0),'g</span>\n            </div>\n          </div>\n        </div>\n        \n        <div class="meal-info-note">\n          <p>This is a default meal. Limited details available.</p>\n        </div>\n      </div>\n    '):'\n      <div class="meal-details-loading">\n        <div class="loading-spinner"></div>\n        <p>Loading meal details...</p>\n      </div>\n    ',c='\n    <div class="meal-details-popup-overlay" id="meal-details-popup-overlay">\n      <div class="meal-details-popup">\n        <div class="meal-details-popup-header">\n          <h2>Meal Details</h2>\n          <button class="popup-close" id="meal-details-close">&times;</button>\n        </div>\n        <div class="meal-details-popup-body">\n          '.concat(s,"\n        </div>\n      </div>\n    </div>\n  "),document.body.insertAdjacentHTML("beforeend",c),d=document.getElementById("meal-details-popup-overlay"),u=document.getElementById("meal-details-close"),p=function(){d&&d.parentNode&&d.parentNode.removeChild(d)},u&&u.addEventListener("click",p),d&&d.addEventListener("click",(function(e){e.target===d&&p()})),!n.recipe_id||null!==(o=n.id)&&void 0!==o&&o.toString().startsWith("default_")){e.next=27;break}return e.prev=14,console.log("üîç Fetching meal details from API for user",i,":",n.recipe_id),e.next=18,a.A.getMealDetails(n.recipe_id);case 18:(m=e.sent)&&m.meal&&(h=m.meal,y='\n          <div class="meal-details-content">\n            <div class="meal-details-header">\n              <img src="'.concat(h.image_url||n.image,'" alt="').concat(h.food_name,'">\n              <div class="meal-basic-info">\n                <h3>').concat(h.food_name,'</h3>\n                <p class="meal-calories">').concat(h.calories_per_serving," kcal per ").concat(h.serving_unit||"serving","</p>\n                ").concat(null!==(f=h.recipe_metadata)&&void 0!==f&&f.total_time?'<p class="meal-time">‚è±Ô∏è '.concat(h.recipe_metadata.total_time," minutes</p>"):"",'\n              </div>\n            </div>\n            \n            <div class="meal-nutrition">\n              <h4>Nutrition per serving:</h4>\n              <div class="nutrition-grid">\n                <div class="nutrition-item">\n                  <span class="nutrition-label">Protein</span>\n                  <span class="nutrition-value">').concat(Math.round(h.protein_per_serving||0),'g</span>\n                </div>\n                <div class="nutrition-item">\n                  <span class="nutrition-label">Carbs</span>\n                  <span class="nutrition-value">').concat(Math.round(h.carbs_per_serving||0),'g</span>\n                </div>\n                <div class="nutrition-item">\n                  <span class="nutrition-label">Fat</span>\n                  <span class="nutrition-value">').concat(Math.round(h.fat_per_serving||0),"g</span>\n                </div>\n              </div>\n            </div>\n\n            ").concat(null!==(v=h.recipe_metadata)&&void 0!==v&&v.ingredients&&h.recipe_metadata.ingredients.length>0?'\n              <div class="meal-ingredients">\n                <h4>Ingredients:</h4>\n                <ul>\n                  '.concat(h.recipe_metadata.ingredients.slice(0,10).map((function(e){return"<li>".concat(e,"</li>")})).join(""),"\n                  ").concat(h.recipe_metadata.ingredients.length>10?"<li><em>... and ".concat(h.recipe_metadata.ingredients.length-10," more ingredients</em></li>"):"","\n                </ul>\n              </div>\n            "):"","\n\n            ").concat(null!==(g=h.recipe_metadata)&&void 0!==g&&g.total_nutrition?'\n              <div class="detailed-nutrition">\n                <h4>Detailed Nutrition:</h4>\n                <div class="nutrition-details-grid">\n                  '.concat(h.recipe_metadata.total_nutrition.fiber?"<div>Fiber: ".concat(Math.round(h.recipe_metadata.total_nutrition.fiber),"g</div>"):"","\n                  ").concat(h.recipe_metadata.total_nutrition.sugar?"<div>Sugar: ".concat(Math.round(h.recipe_metadata.total_nutrition.sugar),"g</div>"):"","\n                  ").concat(h.recipe_metadata.total_nutrition.sodium?"<div>Sodium: ".concat(Math.round(h.recipe_metadata.total_nutrition.sodium),"mg</div>"):"","\n                  ").concat(h.recipe_metadata.total_nutrition.cholesterol?"<div>Cholesterol: ".concat(Math.round(h.recipe_metadata.total_nutrition.cholesterol),"mg</div>"):"","\n                </div>\n              </div>\n            "):"","\n          </div>\n        "),(b=document.querySelector(".meal-details-popup-body"))&&(b.innerHTML=y)),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(14),console.error("Error fetching meal details for user",i,":",e.t0),(_=document.querySelector(".meal-details-popup-body"))&&(_.innerHTML='\n          <div class="meal-details-error">\n            <h4>Error</h4>\n            <p>Failed to load meal details. Please try again.</p>\n            <div class="basic-meal-info">\n              <img src="'.concat(n.image,'" alt="').concat(n.name,'">\n              <h3>').concat(n.name,"</h3>\n              <p>").concat(n.calories," kcal per serving</p>\n            </div>\n          </div>\n        "));case 27:case"end":return e.stop()}}),e,null,[[14,22]])})));return function(n){return e.apply(this,arguments)}}(),h=function(e,n,t){var o=localStorage.getItem("userId")||"anonymous";console.log("üîó Attaching meal plan event handlers for user:",o);var l=document.getElementById("generate-meal-plan-btn"),s=document.getElementById("complete-profile-btn"),c=document.getElementById("add-full-meal-plan-btn"),d=document.querySelectorAll(".meal-plan-add-btn"),u=document.querySelectorAll("[data-meal-details-trigger]");l&&e&&l.addEventListener("click",e),s&&t&&s.addEventListener("click",t),c&&c.addEventListener("click",i(r().mark((function e(){var n,t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.querySelectorAll(".meal-plan-card"),t=[],n.forEach((function(e){var n=e.dataset.userId;if(n&&n!==o)console.warn("‚ö†Ô∏è Skipping meal card from different user:",n);else{var a=e.querySelector(".meal-plan-add-btn");if(a&&a.dataset.meal)try{var r=JSON.parse(a.dataset.meal);r.user_id&&r.user_id!==o?console.warn("‚ö†Ô∏è Skipping meal from different user in meal data:",r.user_id):t.push(r)}catch(e){console.error("Error parsing meal data for user",o,":",e)}}})),!(t.length>0)){e.next=20;break}return c.disabled=!0,c.textContent="Adding Plan...",e.prev=6,e.next=9,v(t);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),console.error("Error adding full meal plan for user",o,":",e.t0);case 14:return e.prev=14,c.disabled=!1,c.innerHTML='<span class="btn-icon">üìã</span> Add Plan',e.finish(14);case 18:e.next=21;break;case 20:alert("No meals found to add");case 21:case"end":return e.stop()}}),e,null,[[6,11,14,18]])})))),d&&d.forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();try{var t=JSON.parse(e.dataset.meal);t.user_id&&t.user_id!==o?(console.warn("‚ö†Ô∏è Attempted to add meal from different user:",t.user_id),alert("Cannot add meal from different user")):function(e){var n,t,o,l=localStorage.getItem("userId")||"anonymous";console.log("üçΩÔ∏è Showing meal plan popup for user",l,":",e);var s=document.getElementById("meal-plan-popup-overlay");s&&s.remove();var c='\n    <div class="meal-popup-overlay" id="meal-plan-popup-overlay">\n      <div class="meal-popup">\n        <div class="meal-popup-header">\n          <h3>Add '.concat(e.name,'</h3>\n          <button class="popup-close" id="meal-plan-popup-close">&times;</button>\n        </div>\n        <div class="meal-popup-content">\n          <div class="form-group">\n            <label for="meal-plan-meal-type">Meal Type:</label>\n            <select id="meal-plan-meal-type" required>\n              <option value="">Select meal type</option>\n              <option value="breakfast" ').concat("breakfast"===(null===(n=e.type)||void 0===n?void 0:n.toLowerCase())?"selected":"",'>Breakfast</option>\n              <option value="lunch" ').concat("lunch"===(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())?"selected":"",'>Lunch</option>\n              <option value="dinner" ').concat("dinner"===(null===(o=e.type)||void 0===o?void 0:o.toLowerCase())?"selected":"",'>Dinner</option>\n              <option value="snack">Snack</option>\n            </select>\n          </div>\n          <div class="form-group">\n            <label for="meal-plan-servings">Servings:</label>\n            <input type="number" id="meal-plan-servings" min="1" step="1" value="1" required>\n          </div>\n          <div class="form-group">\n            <label for="meal-plan-log-date">Date:</label>\n            <input type="date" id="meal-plan-log-date" value="').concat(f(),'" required>\n          </div>\n          <div class="form-actions">\n            <button class="btn-cancel" id="meal-plan-btn-cancel">Cancel</button>\n            <button class="btn-add" id="meal-plan-btn-add">Add</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ');document.body.insertAdjacentHTML("beforeend",c);var d=document.getElementById("meal-plan-popup-overlay"),u=document.getElementById("meal-plan-popup-close"),p=document.getElementById("meal-plan-btn-cancel"),m=document.getElementById("meal-plan-btn-add"),v=function(){d&&d.parentNode&&d.parentNode.removeChild(d)};u&&u.addEventListener("click",v),p&&p.addEventListener("click",v),d&&d.addEventListener("click",(function(e){e.target===d&&v()})),m&&m.addEventListener("click",i(r().mark((function n(){var t,o,i,s,c,d,u,p;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=null===(t=document.getElementById("meal-plan-meal-type"))||void 0===t?void 0:t.value,c=parseFloat(null===(o=document.getElementById("meal-plan-servings"))||void 0===o?void 0:o.value),d=null===(i=document.getElementById("meal-plan-log-date"))||void 0===i?void 0:i.value,s&&c&&d){n.next=6;break}return alert("Please fill all fields"),n.abrupt("return");case 6:if(n.prev=6,m.disabled=!0,m.textContent="Adding...",console.log("üçΩÔ∏è Adding meal for user",l,":",{recipe_id:e.recipe_id,meal_type:s,servings:c,log_date:d}),!e.recipe_id||null!==(u=e.id)&&void 0!==u&&u.toString().startsWith("default_")){n.next=15;break}return n.next=13,a.A.addMealFromPlan({recipe_id:e.recipe_id,meal_type:s,servings:c,log_date:d});case 13:n.next=17;break;case 15:return n.next=17,a.A.createMealEntry({food_item_id:e.id,meal_type:s,servings:c,log_date:d});case 17:alert("Meal added successfully!"),v(),p=new CustomEvent("mealPlanMealAdded"),document.dispatchEvent(p),n.next=29;break;case 23:n.prev=23,n.t0=n.catch(6),console.error("Error adding meal from plan for user",l,":",n.t0),alert("Failed to add meal: ".concat(n.t0.message)),m.disabled=!1,m.textContent="Add";case 29:case"end":return n.stop()}}),n,null,[[6,23]])}))))}(t)}catch(e){console.error("Error parsing meal data for user",o,":",e)}}))})),u&&u.forEach((function(e){e.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var t=e.closest(".meal-plan-card");if(t){var a=t.dataset.userId;if(a&&a!==o)return void console.warn("‚ö†Ô∏è Attempted to view details of meal from different user:",a);var r=t.querySelector(".meal-plan-add-btn");if(r&&r.dataset.meal)try{var i=JSON.parse(r.dataset.meal);i.user_id&&i.user_id!==o?console.warn("‚ö†Ô∏è Attempted to view details of meal from different user in meal data:",i.user_id):g(i)}catch(e){console.error("Error parsing meal data for user",o,":",e)}}}))}))}},275:(e,n,t)=>{function a(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,n){if(e){if("string"==typeof e)return o(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}t.d(n,{Rd:()=>c,sh:()=>s,zq:()=>i});var i={dietary:{title:"Dietary Preferences",icon:"ü•ó",keywords:["vegetarian","vegan","dairy free foods","egg free","lactose free","no shell fish","low calorie","healthy","light","low cholesterol","low protein","very low carbs","high fiber","high protein","protein"]},cooking:{title:"Cooking Style",icon:"üë®‚Äçüç≥",keywords:["no cook","stove top","oven","baking","broil/grill","microwave","pressure cooker","deep fried","steam","stir fry","wok","small appliance","mixer","dehydrator","bread machine"]},mealtime:{title:"Meal Type & Time",icon:"‚è∞",keywords:["breakfast","brunch","lunch","dinner","snacks","dessert","one dish meal","stew","soup","pasta","bread","beverages","< 15 mins","< 30 mins","< 60 mins","weeknight","inexpensive"]},ingredients:{title:"Main Ingredients",icon:"ü•ò",keywords:["chicken","beef","pork","fish","seafood","vegetable","soy/tofu","rice","pasta","beans","cheese","nuts","fruits","berries","mushroom","peppers","onions","spinach","corn"]},cuisine:{title:"Cuisine & Flavors",icon:"üåç",keywords:["chinese","japanese","thai","vietnamese","korean","indian","italian","french","mexican","spanish","mediterranean","spicy","sweet","savory","umami","tangy","sour","mild"]}},l=function(){return Object.values(i).reduce((function(e,n){return[].concat(a(e),a(n.keywords))}),[])},s=function(e){var n={};return Object.keys(i).forEach((function(t){var a=i[t].keywords;n[t]=e.filter((function(e){return a.includes(e)})).length})),n},c=function(e){var n=l();return e.filter((function(e){return n.includes(e)}))}}}]);
//# sourceMappingURL=app~3a552275.bundle.js.map